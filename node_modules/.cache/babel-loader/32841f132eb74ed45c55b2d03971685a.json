{"ast":null,"code":"import _classCallCheck from \"/Users/michaelfoster/Git/avcmerchantappN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/michaelfoster/Git/avcmerchantappN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/michaelfoster/Git/avcmerchantappN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/michaelfoster/Git/avcmerchantappN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/michaelfoster/Git/avcmerchantappN/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/michaelfoster/Git/avcmerchantappN/src/components/order-row.js\";\nimport React, { Component } from \"react\";\nimport dayjs from \"dayjs\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nvar containerStyles = {\n  display: \"flex\",\n  padding: \"20px\",\n  justifyContent: \"space-between\"\n};\nvar orderInfoStyles = {\n  display: \"flex\",\n  flexDirection: \"column\",\n  flex: 3,\n  borderBottomLeftRadius: '10px'\n};\nvar orderInfoWrapper = {\n  display: \"flex\",\n  justifyContent: \"space-between\",\n  padding: \"20px\",\n  background: 'white',\n  borderTopLeftRadius: '10px'\n};\nvar customerDetailsStyles = {\n  display: \"flex\",\n  flex: 1\n};\nvar orderDetailsStyles = {\n  display: \"flex\",\n  flexDirection: \"column\",\n  padding: \"20px\",\n  paddingTop: \"0\",\n  background: 'white',\n  borderBottomLeftRadius: '10px'\n};\nvar actionStyles = {\n  flex: 1,\n  padding: \"20px\",\n  background: \"green\",\n  color: \"white\",\n  fontSize: \"24px\",\n  border: \"1px solid green\",\n  borderTopRightRadius: '10px',\n  borderBottomRightRadius: '10px'\n};\nvar titleStyles = {\n  fontWeight: \"bold\",\n  padding: \"10px 0\"\n};\n\nvar Order =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Order, _Component);\n\n  function Order() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Order);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Order)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.updateStatus = function () {\n      var _this$props = _this.props,\n          updateOrder = _this$props.updateOrder,\n          order = _this$props.order;\n      var updateFields = order.updateFields,\n          processed = order.processed,\n          id = order.id;\n      var newCompletionTime = new Date().toISOString();\n\n      if (updateFields) {\n        updateOrder({\n          id: id,\n          processed: !processed,\n          completed_time: newCompletionTime,\n          order_is_ready: !processed\n        });\n        updateFields({\n          processed: !processed,\n          completed_time: newCompletionTime,\n          order_is_ready: !processed\n        }).catch(function (error) {\n          console.error(error);\n          toast.error(\"Please refresh the page, we are having issues with the connection.\");\n          updateOrder({\n            id: id,\n            processed: processed\n          }); // Set order back to the original state\n        });\n      } else {\n        _this.sendSms();\n\n        updateOrder({\n          id: id,\n          processed: !processed,\n          completed_time: newCompletionTime,\n          order_is_ready: !processed\n        });\n        axios.patch(\"https://api.airtable.com/v0/app4XnP7NuSCWMWD7/Orders/\".concat(id), {\n          fields: {\n            processed: !processed,\n            completed_time: newCompletionTime,\n            order_is_ready: !processed,\n            Price: 'evanRulez'\n          }\n        }, {\n          headers: {\n            Authorization: \"Bearer \".concat(process.env.REACT_APP_AIRTABLE_API_KEY)\n          }\n        }).catch(function (error) {\n          console.error(error);\n          toast.error(\"Please refresh the page, we are having issues with the connection.\");\n          updateOrder({\n            id: id,\n            processed: processed,\n            order_is_ready: !processed\n          });\n        });\n      }\n    };\n\n    _this.getOrderTotal = function () {\n      var items = _this.props.order.items;\n      var itemTotals = items.length && items.reduce(function (total, currentItem) {\n        var itemQuantity = currentItem.quantity || 1;\n        var totalPerItem = +currentItem.item.price * itemQuantity;\n        var addonTotal = currentItem.addons.length && currentItem.addons.reduce(function (total, currentAddon) {\n          var totalPerAddon = +currentAddon.price * itemQuantity;\n          return total + totalPerAddon;\n        }, 0) || 0;\n        return total + totalPerItem + addonTotal;\n      }, 0) || 0;\n      return itemTotals.toFixed(2);\n    };\n\n    return _this;\n  }\n\n  _createClass(Order, [{\n    key: \"render\",\n    value: function render() {\n      var order = this.props.order;\n      var customer_name = order.customer_name,\n          table_number = order.table_number,\n          created_time = order.created_time,\n          items = order.items,\n          processed = order.processed,\n          id = order.id;\n      var prettyTime = dayjs(created_time).format(\"hh:mm A\");\n      var prettyDate = dayjs(created_time).format(\"DD-MM-YYYY\");\n      var orderTotal = this.getOrderTotal();\n      return React.createElement(\"div\", {\n        key: id,\n        style: containerStyles,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: orderInfoStyles,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: orderInfoWrapper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: customerDetailsStyles,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, customer_name), \"\\xA0-\\xA0\", React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, table_number)), React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          flexDirection: \"column\",\n          alignItems: \"flex-end\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, prettyTime), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, prettyDate))), React.createElement(\"div\", {\n        style: orderDetailsStyles,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, items.map(function (item) {\n        var itemQuantity = item.quantity || \"1\";\n        var itemTotal = (+item.item.price * +itemQuantity).toFixed(2);\n        return React.createElement(\"div\", {\n          key: \"\".concat(id, \"-\").concat(item.item.id),\n          style: {\n            paddingBottom: \"20px\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: titleStyles,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }, \"Item\"), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, itemQuantity, \" x \", item.item.name, \" ($ \", itemTotal, \")\"), React.createElement(\"div\", {\n          style: titleStyles,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 205\n          },\n          __self: this\n        }, \"Extras\"), React.createElement(\"div\", {\n          style: {\n            display: \"flex\",\n            flexDirection: \"column\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }, item.addons.map(function (addon) {\n          var addonTotal = (+addon.price * +itemQuantity).toFixed(2);\n          return React.createElement(\"span\", {\n            key: \"\".concat(id, \"-\").concat(item.item.id, \"-\").concat(addon.id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 212\n            },\n            __self: this\n          }, addon.name, \" ($ \", addonTotal, \")\");\n        })));\n      }), React.createElement(\"div\", {\n        style: {\n          fontWeight: \"bold\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, \"Total: $ \", orderTotal))), React.createElement(\"button\", {\n        style: actionStyles,\n        onClick: this.updateStatus,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, processed ? \"Undo\" : \"Complete\"));\n    }\n  }]);\n\n  return Order;\n}(Component);\n\nexport default Order;","map":{"version":3,"sources":["/Users/michaelfoster/Git/avcmerchantappN/src/components/order-row.js"],"names":["React","Component","dayjs","axios","toast","containerStyles","display","padding","justifyContent","orderInfoStyles","flexDirection","flex","borderBottomLeftRadius","orderInfoWrapper","background","borderTopLeftRadius","customerDetailsStyles","orderDetailsStyles","paddingTop","actionStyles","color","fontSize","border","borderTopRightRadius","borderBottomRightRadius","titleStyles","fontWeight","Order","updateStatus","props","updateOrder","order","updateFields","processed","id","newCompletionTime","Date","toISOString","completed_time","order_is_ready","catch","error","console","sendSms","patch","fields","Price","headers","Authorization","process","env","REACT_APP_AIRTABLE_API_KEY","getOrderTotal","items","itemTotals","length","reduce","total","currentItem","itemQuantity","quantity","totalPerItem","item","price","addonTotal","addons","currentAddon","totalPerAddon","toFixed","customer_name","table_number","created_time","prettyTime","format","prettyDate","orderTotal","alignItems","map","itemTotal","paddingBottom","name","addon"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport dayjs from \"dayjs\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\n\nconst containerStyles = {\n  display: \"flex\",\n  padding: \"20px\",\n  justifyContent: \"space-between\"\n};\n\nconst orderInfoStyles = {\n  display: \"flex\",\n  flexDirection: \"column\",\n  flex: 3,\n  \n  borderBottomLeftRadius: '10px',\n};\n\nconst orderInfoWrapper = {\n  display: \"flex\",\n  justifyContent: \"space-between\",\n  padding: \"20px\",\n  background: 'white',\n  borderTopLeftRadius: '10px',\n};\n\nconst customerDetailsStyles = {\n  display: \"flex\",\n  flex: 1,\n};\n\nconst orderDetailsStyles = {\n  display: \"flex\",\n  flexDirection: \"column\",\n  padding: \"20px\",\n  paddingTop: \"0\",\n  background: 'white',\n  borderBottomLeftRadius: '10px',\n};\n\nconst actionStyles = {\n  flex: 1,\n  padding: \"20px\",\n  background: \"green\",\n  color: \"white\",\n  fontSize: \"24px\",\n  border: \"1px solid green\",\n  borderTopRightRadius: '10px',\n  borderBottomRightRadius: '10px',\n  \n};\n\nconst titleStyles = { fontWeight: \"bold\", padding: \"10px 0\" };\n\nclass Order extends Component {\n  updateStatus = () => {\n    const { updateOrder, order } = this.props;\n    const { updateFields, processed, id } = order;\n    const newCompletionTime = new Date().toISOString();\n\n    if (updateFields) {\n      updateOrder({\n        id,\n        processed: !processed,\n        completed_time: newCompletionTime,\n        order_is_ready: !processed,\n      });\n      updateFields({\n        processed: !processed,\n        completed_time: newCompletionTime,\n        order_is_ready: !processed,\n      }).catch(error => {\n        console.error(error);\n        toast.error(\n          \"Please refresh the page, we are having issues with the connection.\"\n        );\n        updateOrder({ id, processed: processed }); // Set order back to the original state\n      });\n    } else {\n      this.sendSms()\n      updateOrder({\n        id,\n        processed: !processed,\n        completed_time: newCompletionTime,\n        order_is_ready: !processed,\n      });\n\n      axios\n        .patch(\n          `https://api.airtable.com/v0/app4XnP7NuSCWMWD7/Orders/${id}`,\n          {\n            fields: {\n              processed: !processed,\n              completed_time: newCompletionTime,\n              order_is_ready: !processed,\n              Price: 'evanRulez',\n            }\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${process.env.REACT_APP_AIRTABLE_API_KEY}`\n            }\n          }\n        )\n        .catch(error => {\n          console.error(error);\n          toast.error(\n            \"Please refresh the page, we are having issues with the connection.\"\n          );\n          updateOrder({ id, processed: processed, order_is_ready: !processed, });\n        });\n        \n    }\n  };\n\n /* sendSms(){\n    console.log('here')\n    const payload = {};\n payload.headers = {\n   'Content-Type': 'application/json',\n   // Authorization: `bearer ${getToken()}`,\n };\n payload.method='POST';\n\n fetch(`localhost:5000/yumbff/ordering/sms`, payload).then((response) => {\n  if (response.ok) {\n    if (true) {\n      return response.json();\n    }\n    return response;\n  }\n  throw Error(`Api request failed with status code: ${response.status}`);\n});\n\n  }*/\n\n  getOrderTotal = () => {\n    const { items } = this.props.order;\n    const itemTotals =\n      (items.length &&\n        items.reduce((total, currentItem) => {\n          const itemQuantity = currentItem.quantity || 1;\n          const totalPerItem = +currentItem.item.price * itemQuantity;\n          const addonTotal =\n            (currentItem.addons.length &&\n              currentItem.addons.reduce((total, currentAddon) => {\n                const totalPerAddon = +currentAddon.price * itemQuantity;\n                return total + totalPerAddon;\n              }, 0)) ||\n            0;\n          return total + totalPerItem + addonTotal;\n        }, 0)) ||\n      0;\n    return itemTotals.toFixed(2);\n  };\n\n  render() {\n    const { order } = this.props;\n    const {\n      customer_name,\n      table_number,\n      created_time,\n      items,\n      processed,\n      id\n    } = order;\n\n    const prettyTime = dayjs(created_time).format(\"hh:mm A\");\n    const prettyDate = dayjs(created_time).format(\"DD-MM-YYYY\");\n\n    const orderTotal = this.getOrderTotal();\n\n    return (\n      <div key={id} style={containerStyles}>\n        <div style={orderInfoStyles}>\n          <div style={orderInfoWrapper}>\n            <div style={customerDetailsStyles}>\n              <div>{customer_name}</div>&nbsp;-&nbsp;<div>{table_number}</div>\n            </div>\n            <div\n              style={{\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"flex-end\"\n              }}\n            >\n              <div>{prettyTime}</div>\n              <div>{prettyDate}</div>\n            </div>\n          </div>\n          <div style={orderDetailsStyles}>\n            {items.map(item => {\n              const itemQuantity = item.quantity || \"1\";\n              const itemTotal = (+item.item.price * +itemQuantity).toFixed(2);\n              return (\n                <div\n                  key={`${id}-${item.item.id}`}\n                  style={{ paddingBottom: \"20px\" }}\n                >\n                  <div style={titleStyles}>Item</div>\n                  <div>\n                    {itemQuantity} x {item.item.name} ($ {itemTotal})\n                  </div>\n                  <div style={titleStyles}>Extras</div>\n                  <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n                    {item.addons.map(addon => {\n                      const addonTotal = (+addon.price * +itemQuantity).toFixed(\n                        2\n                      );\n                      return (\n                        <span key={`${id}-${item.item.id}-${addon.id}`}>\n                          {addon.name} ($ {addonTotal})\n                        </span>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n            <div style={{ fontWeight: \"bold\" }}>Total: $ {orderTotal}</div>\n          </div>\n        </div>\n        <button style={actionStyles} onClick={this.updateStatus}>\n          {processed ? \"Undo\" : \"Complete\"}\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Order;\n"]},"metadata":{},"sourceType":"module"}